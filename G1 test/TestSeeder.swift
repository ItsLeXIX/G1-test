//
//  TestSeeder.swift
//  G1 test
//
//  Created by Parsa Jalali on 04.08.25.
//

import Foundation
import CoreData

struct TestSeeder {
    /// Backward compatible entrypoint
    static func seed(context: NSManagedObjectContext) {
        seedIfNeeded(context: context)
    }

    /// Idempotent seeder: inserts questions 1...20 only if they are missing
    static func seedIfNeeded(context: NSManagedObjectContext) {
        func exists(id: Int) -> Bool {
            let r: NSFetchRequest<Question> = Question.fetchRequest()
            r.predicate = NSPredicate(format: "id == %d", id)
            return ((try? context.count(for: r)) ?? 0) > 0
        }

        func add(_ id: Int, _ text: String, _ a: String, _ b: String, _ c: String, _ d: String, _ correct: String, _ category: String) {
            // Upsert: update if exists, insert if missing
            let req: NSFetchRequest<Question> = Question.fetchRequest()
            req.fetchLimit = 1
            req.predicate = NSPredicate(format: "id == %d", id)
            let existing = try? context.fetch(req).first

            let q: Question
            if let found = existing {
                q = found
            } else {
                q = Question(context: context)
                q.id = Int32(id)
            }

            q.question = text
            q.optionA = a
            q.optionB = b
            q.optionC = c
            q.optionD = d
            q.correctOption = correct
            q.category = category
            q.imageName = ""
            q.userChoice = ""
        }

        // IDs 1...20 (10 Signs, 10 Rules)
        add(1,  "What does a red traffic light mean?", "Stop", "Go", "Yield", "Speed up", "A", "Rules of the Road")
        add(2,  "When should you yield at an intersection?", "When you see a stop sign", "When entering from a side road", "Only if there are pedestrians", "Never", "B", "Rules of the Road")
        add(3,  "What shape is a STOP sign?", "Octagon", "Triangle", "Circle", "Rectangle", "A", "Signs")
        add(4,  "At a four‑way stop, who has the right‑of‑way?", "The largest vehicle", "The vehicle that stops first", "The vehicle on the left", "Whoever flashes headlights", "B", "Rules of the Road")
        add(5,  "A YIELD sign means you must…", "Slow down and give right‑of‑way", "Stop completely every time", "Speed up to merge first", "Ignore if no police are present", "A", "Signs")
        add(6,  "What is the minimum safe following distance in good conditions?", "Two‑second rule", "Half a car length", "One second", "Five car lengths", "A", "Rules of the Road")
        add(7,  "This sign warns of a train crossing ahead. What should you do?", "Speed up to beat the train", "Look, listen, and be prepared to stop", "Turn around immediately", "Park on the tracks briefly", "B", "Signs")
        add(8,  "What must you do when a school bus has flashing red lights?", "Pass carefully on the left", "Slow down and proceed", "Stop from both directions until the lights stop", "Honk and continue", "C", "Rules of the Road")
        add(9,  "‘Divided highway begins’ means…", "A median will separate directions ahead", "Road narrows to one lane", "Two‑way traffic ends", "One‑way street begins", "A", "Signs")
        add(10, "A solid yellow line on your side of the road means…", "No passing", "Passing allowed", "Bus lane", "Bike lane", "A", "Rules of the Road")
        add(11, "This sign means the road may be slippery when wet. What should you do?", "Brake hard", "Slow down and avoid sudden moves", "Turn off headlights", "Speed up to dry the tires", "B", "Signs")
        add(12, "When must you use headlights?", "Only on highways", "Only in rain", "Only outside cities", "From sunset to sunrise or when visibility is poor", "D", "Rules of the Road")
        add(13, "Two‑way traffic ahead sign warns you to…", "Expect traffic only in your lane", "Expect oncoming traffic", "Road closed ahead", "Freeway begins", "B", "Signs")
        add(14, "When an emergency vehicle approaches with lights and siren, you must…", "Maintain speed", "Stop in your lane", "Pull to the right and stop", "Speed up to clear the way", "C", "Rules of the Road")
        add(15, "No‑passing zone (pennant) means…", "Bus lane ahead", "Passing allowed for trucks", "Do not pass in this area", "Keep right of island", "C", "Signs")
        add(16, "What should you do if you start to hydroplane?", "Brake hard and steer sharply", "Accelerate to regain traction", "Ease off the accelerator and steer gently", "Turn off traction control", "C", "Rules of the Road")
        add(17, "Merge sign indicates you should…", "Stop and wait", "Adjust speed and merge when safe", "Make a U‑turn", "Drive on the shoulder", "B", "Signs")
        add(18, "What is the legal blood‑alcohol limit for G1 drivers?", "0.05", "0.00 (zero tolerance)", "0.03", "0.08", "B", "Rules of the Road")
        add(19, "Pedestrian crossing sign means…", "No pedestrians allowed", "Playground ahead", "Pedestrian crossing ahead—be prepared to stop", "School bus stop only", "C", "Signs")
        add(20, "A flashing amber (yellow) traffic light means…", "Stop and wait for green", "Stop, then proceed when safe", "Speed up to clear the intersection", "Proceed with caution", "D", "Rules of the Road")

        // --- Reset Persian ranges: delete any existing 100...139 to avoid stale data ---
        do {
            let fetch: NSFetchRequest<Question> = Question.fetchRequest()
            fetch.predicate = NSPredicate(format: "id >= %d AND id <= %d", 100, 139)
            let old = try context.fetch(fetch)
            for obj in old { context.delete(obj) }
            if context.hasChanges { try context.save() }
        } catch {
            print("Warning: could not delete old Persian questions (100...139): \(error)")
        }

        // --- Reset Persian Test 3: delete any existing 140...159 to avoid stale data ---
        do {
            let fetch3: NSFetchRequest<Question> = Question.fetchRequest()
            fetch3.predicate = NSPredicate(format: "id >= %d AND id <= %d", 140, 159)
            let old3 = try context.fetch(fetch3)
            for obj in old3 { context.delete(obj) }
            if context.hasChanges { try context.save() }
        } catch {
            print("Warning: could not delete old Persian questions (140...159): \(error)")
        }

        // Persian Test 1 — IDs 100...119 (Signs)
        add(100, "اين علامت ساختمانى به چه معناست؟",
                    "خیابان سنگفرش آسياب شده يا شياردار است",
                    "عمليات راهدارى در پيش است.", "تابلوى ساخت و ساز جایگزین پرچمدار در حال انجام وظيفه.",
                    "علامت ساخت و ساز براى كاهش سرعت و اطاعت از جهت پرچم.", "B", "علائم")

                add(101, "اين تابلوى راه به چه معناست؟",
                    "شما بايد به چپ بپیچید.", "بايد به راست بپیچید",
                    "شما بايد مستقيم برويد.", "همه چرخش ها مجاز است.", "B", "علائم")

                add(102, "اين تابلوى راه پشت خودرو به چه معناست؟",
                    "خودرویی با سرعت كم", "تابلوى ايست در پيش رو",
                    "وسيله نقليه دارای حمل مواد خطرناك", "حق تقدم را بدهيد", "A", "علائم")

                add(103, "اين تابلوى راه به چه معناست?",
                    "هتل", "مسابقه اسب دوانى", "تپه ها", "بيمارستان", "D", "علائم")

                add(104, "اين تابلوى راه به چه معناست؟",
                    "هیچ چیز مجاز نيست", "دور برگردان مجاز است",
                    "گردش به چپ ممنوع", "دور زدن ممنوع است", "D", "علائم")

                add(105, "اين تابلوى راه به چه معناست؟",
                    "هواپيما وجود دارد.", "فرود هواپیما", "مسير به يك فرودگاه.", "نمايش هوايي در پيش است.", "C", "علائم")

                add(106, "اين تابلوى راه به چه معناست؟",
                    "پارک کردن به سمت راست", "اين جاده كمى به سمت راست در جلو مى چرخد.",
                    "اين جاده جلوتر به طور تند به سمت راست مى چرخد", "ترافيك بايد از راست خارج شود.", "C", "علائم")

                add(107, "اين تابلوى راه به چه معناست؟",
                    "گردش به چب ممنوع.", "مستقيم رفتن مجاز نيست.",
                    "مستقيم رفتن مجاز است.", "گردش به راست مجاز نيست.", "B", "علائم")

                add(108, "اين تابلوى راه به چه معناست؟",
                    "اب روى جاده است", "سطح جاده ناهموار يا پر از دست انداز در پيش رو",
                    "جاده باريك در پيش رو", "پل در پيش رو بالا می‌رود تا اجازه عبور قايقها رابدهد", "D", "علائم")

                add(109, "اين تابلوى راه به چه معناست؟",
                    "شما بايد حق تقدم را بدهيد.", "شما حق تقدم داريد.",
                    "در جلو منطقه مدرسه است.", "در جلو يك تقاطع راه آهن قرار دارد.", "A", "علائم")

                add(110, "اين علامت نشان مى دهد",
                    "يك وضعيت موقت", "يك ممنوعيت", "اخطار", "اطلاعات و جهت", "B", "علائم")

                add(111, "اين تابلوى راه به چه معناست؟",
                    "فقط پاركينك ماشين برفى (اسنوموبيل)", "ماشين هاى برفى (اسنوموبيل) مى توانند از اين جاده استفاده كنند",
                    "عبور ماشين برفى (اسنوموبيل) از اين جاده ممنوع است", "تعميركاه ماشين برفى (اسنوموبيل) در پيش است.", "B", "علائم")

                add(112, "اين علامت به چه معناست؟",
                    "فاصله مشخصى را حفظ كنيد", "در جلو عمليات ساختمانى در حال انجام است",
                    "راه جلوتر بسته است! در ترافيك ادغام شويد", "علائم مسير انحرافى را دنبال كنيد تا به مسير اصلى بازگردید", "D", "علائم")

                add(113, "اين تابلوى راه به چه معناست؟",
                    "چراغ راهنمای ترافيكى در پيش رو.", "تقاطع راه آهن جلوتر.",
                    "تابلو ايست در پيش رو.", "دست انداز در پيش رو.", "A", "علائم")

                add(114, "اين تابلوى راه به چه معناست؟",
                    "روشن گذاشتن موتور خودرو در حالت ساکن برای بیش از ۳ دقیقه ممنوع است.", "توقف بيش از 3 دقيقه غیر مجاز است",
                    "بيش از 3 دقيقه سیگار نكشيد", "پارک کردن خودرو در این محدوده به مدت ۳ دقیقه مجاز است.", "A", "علائم")

                add(115, "اين تابلوى راه به چه معناست؟",
                    "مراقب عابران پياده باشيد", "سرعت خود را كم نكنيد.",
                    "تقاطع را مسدود نكنيد.", "در تقاطع سرعت خود را افزايش دهيد.", "C", "علائم")

                add(116, "اين تابلوى راه به چه معناست؟",
                    "سبقت گرفتن ممنوع", "پارك ممنوع", "ورود سواری ممنوع", "توقف نکنید", "A", "علائم")

                add(117, "اين تابلوى راه به چه معناست؟",
                    "گردش به راست مجاز نيست.", "گردش به چپ مجاز نيست.",
                    "يك جاده فرعى پنهان در جلو وجود دارد.", "دور برگردان مجاز نيست.", "C", "علائم")

                add(118, "اين تابلوى راه به چه معناست؟",
                    "پارک ممنوع", "توقف ممنوع", "ورود دوچرخه به اين جاده ممنوع است.", "دوچرخه ها در اين جاده مجاز هستند.", "C", "علائم")

                add(119, "اين تابلوى راه به چه معناست؟",
                    "اجازه پارك در هر زمانى وجود ندارد.", "شما نمى توانيد در زمان هاى اعلام شده بين تابلوها پارك كنيد.",
                    "شما مى توانيد در منطقه مشخص شده در زمان هاى اعلام شده پارك كنيد.", "فقط پارک کردن در آخر هفته ممنوع نيست.", "C", "علائم")

                // --- Persian Test 2: Rules (IDs 120...139) ---
                add(120, "اگر راننده‌اى به دليل بى‌احتياطى رانندگى محكوم شود، شش امتياز منفى دريافت مى‌كند و مى‌تواند با چه چيزى مواجه شود؟",
                    "همه موارد فوق", "جريمه تا 2000 دلار", "حبس تا شش ماه", "تعليق مجوز تا دوسال", "A", "قوانین رانندگی")

                add(121, "هنگام رانندگى در يك خيابان دوطرفه صداى آژير وسيله نقليه اضطرارى را مى‌شنويد، قانون شما را ملزم به چه كارى مى‌كند؟",
                    "سرعت بگيريد و از مسير خارج شويد", "به راننده علامت بدهيد كه عبور كند",
                    "تا جايى كه امكان دارد به راست بكشيد و متوقف شويد", "با همان سرعت ادامه دهيد", "C", "قوانین رانندگی")

                add(122, "هنگام رانندگى اگر تماسى دريافت كنيد و كسى نيست كه پاسخ دهد، چه كارى بايد بكنيد؟",
                    "قبل از استفاده از تلفن كنار بكشيد و پارك كنيد", "به تلفن پاسخ دهيد و سريع قطع كنيد",
                    "فوراً تلفن را پاسخ دهيد", "پيامك بدهيد كه در حال رانندگى هستيد", "A", "قوانین رانندگی")

                add(123, "چراغ سبز چشمك‌زن در تقاطع يعنى…",
                    "مى‌توانيد به راست بپيچيد", "مى‌توانيد مستقيم برويد", "همه موارد فوق", "مى‌توانيد به چپ بپيچيد", "C", "قوانین رانندگی")

                add(124, "در چه شرايطى مى‌توان گواهينامه رانندگى را باطل كرد؟",
                    "هريك از شرايط فوق", "دستكارى يا جعل گواهينامه", "عدم موفقيت در بازآزمون", "عدم حضور در آزمون يا معاينه پزشكى الزامى", "A", "قوانین رانندگی")

                add(125, "محكوميت به فرار از پليس: تعليق گواهينامه تا چه مدت؟",
                    "5 سال", "5 هفته", "5 ماه", "3 روز", "A", "قوانین رانندگی")

                add(126, "راننده G2، 19 ساله با بيش از 6 ماه تجربه: بين نيمه‌شب تا 5 صبح چند مسافر ناشناس 19 ساله يا كمتر مى‌تواند حمل كند؟",
                    "2", "4", "1", "3", "D", "قوانین رانندگی")

                add(127, "در انتاريو شب‌ها كى بايد نوربالا را كم كنيد؟",
                    "وقتى 150 مترى وسيله نقليه ديگر هستيد", "وقتى 400 مترى وسيله نقليه ديگر هستيد",
                    "وقتى 60 مترى روبه‌رو يا 150 مترى خودرویى كه دنبال مى‌كنيد هستيد", "وقتى 150 مترى روبه‌رو يا 60 مترى خودرویى كه دنبال مى‌كنيد هستيد", "D", "قوانین رانندگی")

                add(128, "وقتى در ميدان هستيد…",
                    "در جهت عقربه‌هاى ساعت برانيد", "مى‌توانيد خط را تغيير دهيد", "مى‌توانيد متوقف شويد", "در خلاف جهت عقربه‌هاى ساعت برانيد", "D", "قوانین رانندگی")

                add(129, "به تقاطعى مى‌رسيد كه چراغ‌ها كار نمى‌كنند. چه بايد كرد؟",
                    "حق تقدم را رها نكنيد", "سرعت را كم كنيد و با احتياط ادامه دهيد",
                    "مثل چهارراه داراى تابلو توقف رفتار كنيد", "سرعت گرفته و با احتياط ادامه دهيد", "C", "قوانین رانندگی")

                add(130, "چراغ قرمز است و افسر پليس به شما اشاره مى‌كند عبور كنيد. چه مى‌كنيد؟",
                    "بايستيد و مطمئن شويد",
                    "صبر كنيد تا سبز شود",
                    "عبور كنيد",
                    "به افسر بگوييد چراغ قرمز است",
                    "C", "قوانین رانندگی")

                add(131, "لاستيك شما ناگهان مى‌تركد. چه مى‌كنيد؟",
                    "خودرو را خارج از جاده متوقف كنيد", "تمركز را بر هدايت بگذاريد", "تمام موارد بالا", "پا را از روى گاز برداريد", "C", "قوانین رانندگی")

                add(132, "نزديك تقاطع چراغ از سبز به زرد تغيير مى‌كند. چه كنيد؟",
                    "سرعت را زياد كنيد و عبور كنيد", "اگر ايمن است توقف كنيد؛ وگرنه با احتياط عبور كنيد",
                    "به عابرين هشدار دهيد", "به رانندگان هشدار دهيد", "B", "قوانین رانندگی")

                add(133, "راننده داراى گواهينامه كامل با 15 امتياز منفى: تعليق به مدت…",
                    "1 هفته", "2 هفته", "30 روز", "3 ماه", "C", "قوانین رانندگی")

                add(134, "در تصادف داراى مصدوم، بايد حادثه را به چه كسى گزارش كنيد؟",
                    "پليس بلافاصله", "وزارت حمل و نقل بلافاصله", "پليس ظرف 48 ساعت", "وزارت حمل و نقل ظرف 48 ساعت", "A", "قوانین رانندگی")

                add(135, "حداقل فاصله هنگام سبقت از دوچرخه‌سوار؟",
                    "2 متر", "1.5 متر", "1 متر", "0.5 متر", "C", "قوانین رانندگی")

                add(136, "تغيير آدرس يا نام: تا چه زمانى بايد به وزارت اطلاع دهيد؟",
                    "10 روز", "6 روز", "2 هفته", "1 ماه", "B", "قوانین رانندگی")

                add(137, "راننده G1/G2 با الكل يا مواد مخدر: با كدام مجازات‌ها مواجه مى‌شود؟",
                    "همه موارد فوق", "تعليق 30 روزه پس از محكوميت", "تعليق فورى 3 روزه", "جريمه 60 تا 500 دلار پس از محكوميت", "A", "قوانین رانندگی")

                add(138, "اتوبوس مدرسه با چراغ قرمز چشمك‌زن و بازوى توقف باز ايستاده است…",
                    "بهتر است حداقل 20 متر فاصله بگيريد", "اگر در طرف مقابل هستيد مى‌توانيد ادامه دهيد",
                    "بايد حداقل 20 متر فاصله بگيريد", "سرعت را تا 20 كيلومتر كاهش دهيد", "C", "قوانین رانندگی")

                add(139, "به علامت ادغام ترافيك نزديك مى‌شويد. چه مى‌كنيد؟",
                    "بوق بزنيد", "سرعت و موقعيت را تنظيم كنيد", "اول اجازه دهيد ماشين‌هاى پشت بروند", "توقف كامل كرده سپس حركت كنيد", "B", "قوانین رانندگی")

                // --- Persian Test 3: Signs (IDs 140...159) ---
                // Ensure Q140 is fresh (delete if lingering, then re-insert below)
                do {
                    let one: NSFetchRequest<Question> = Question.fetchRequest()
                    one.fetchLimit = 1
                    one.predicate = NSPredicate(format: "id == %d", 140)
                    if let found = try context.fetch(one).first {
                        context.delete(found)
                        try context.save()
                    }
                } catch {
                    print("Warning: could not force-refresh Q140: \(error)")
                }
                add(140, "اين علامت به چه معناست؟",
                    "شما بايد به خط سمت راست حركت كنيد.",
                    "شما نبايد در لاين سمت راست رانندگى كنيد.",
                    "اگر در لاين سمت راست باقى بمانيد مى توانيد خارج شويد.",
                    "اگر در لاين سمت راست باقى مانده ايد بايد خارج شويد.",
                    "D", "علائم")

                add(141, "اين تابلوى راه به چه معناست؟",
                    "ورودى كاميون جلوتر",
                    "منطقه مدرسه جلوتر",
                    "ايستگاه مخفى اتوبوس مدرسه جلوتر",
                    "تقاطع مخفى پيش رو",
                    "C", "علائم")

                add(142, "شما به يك علامت رعایت حق تقدم نزديك مى شويد. چه كارى بايد انجام دهيد؟",
                    "بوق خود را به صدا دربیاورید",
                    "توقف كنيد، سپس به آرامى وارد ترافيك شويد.",
                    "توقف كنيد، سپس سريع وارد ترافيك شويد.",
                    "سرعت خود را كم كنيد، در صورت لزوم توقف كنيد، ودر مسير حق تقدم قرار بگيريد.",
                    "D", "علائم")

                add(143, "اين علامت به چه معناست؟",
                    "تقاطع كنترل نشده",
                    "محل عبور عابر پياده",
                    "وارد نشويد",
                    "گذرگاه راه آهن",
                    "D", "علائم")

                add(144, "اين تابلوى راه به چه معناست؟",
                    "وارد نشويد.",
                    "ايستادن ممنوع است",
                    "سبقت ممنوع",
                    "پارك نكنيد.",
                    "A", "علائم")

                add(145, "اين علامت به چه معناست؟",
                    "پل باريك پیش رو است .",
                    "جاده در حال ساخت ",
                    "بزرگراه تقسيم شده آغاز مى شود.",
                    "بزرگراه تقسيم شده به پايان مى رسد.",
                    "C", "علائم")

                add(146, "اين تابلوى راه به چه معناست؟",
                    "فقط ورود حيوانات خانگى مجاز هستند",
                    "ورود عابر پياده ممنوع است",
                    "ورود دوچرخه مجاز نيست",
                    "ممنوعيت ورود كودكان",
                    "B", "علائم")

                add(147, "اين علامت به چه معناست؟",
                    "شما نبايد در لاين سمت راست رانندگى كنيد.",
                    "اين يك لاین دو طرفه برای گردش به چپ است",
                    "بزرگراه جلوتر به پايان مى رسد.",
                    "جاده در حال منشعب شدن است",
                    "B", "علائم")

                add(148, "اين علامت به چه معناست؟",
                    "محل پارك مخصوص معلولين",
                    "تيم نقشه بردارى در جلو مشغول به كار است",
                    "بيمارستان در پيش رو است ",
                    "توقف در هر زمانى ممنوع است ",
                    "A", "علائم")

                add(149, "اين تابلوى راه به چه معناست؟",
                    "راه پر پيج و خم",
                    "هنگام خيس بودن جاده لغزنده است",
                    "جاده به چپ و سپس به راست مى پيجد",
                    "خروجى خط به سمت راست.",
                    "A", "علائم")

                add(150, "اين تابلوى راه به چه معناست؟",
                    "ممكن است آب روى جاده جارى شود",
                    "وارد جاده نشويد.",
                    "منطقه ساخت و ساز در پيش است.",
                    "ورودى كاميون جلوتر.",
                    "A", "علائم")

                add(151, "اين تابلوى راه به چه معناست؟",
                    "مسير كاميون.",
                    "علامت منع",
                    "مسير دوچرخه سوارى.",
                    "علامت مجاز.",
                    "D", "علائم")

                add(152, "اين تابلوى راه به چه معناست؟",
                    "مى توانيد با چراغ قرمز به سمت راست بپيچيد.",
                    "بزرگراه تقسيم شده به پايان مى رسد.",
                    "شما نمى توانيد با چراغ سبز به سمت راست بپيچيد.",
                    "شما نبايد روى چراغ قرمز به سمت راست بپيچيد.",
                    "D", "علائم")

                add(153, "این علامت به چه معناست؟",
                    "وجود مانع در جلو و خط شیب دار نشان می‌دهد از کدام سمت عبور کنید",
                    "این محل برای توقف و استراحت است.",
                    "مسیر در اینجا به بن‌بست می‌رسد.",
                    "خط صعودى نشان مى دهد از كدام سمت         سبقت بگيريد.",
                    "A", "علائم")

                add(154, "اين علامت به چه معناست؟",
                    "در طول زمان ها و روزهاى نوشته شده متوقف نشويد.",
                    "در زمان ها و روزهاى نوشته شده وارد نشويد.",
                    "فقط انواع خاصى از وسايل نقليه مجاز به تردد در اين خط در زمان ها وروزهاى نوشته شده هستند.",
                    "در ساعات و روزهاى نوشته شده فقط دوچرخه مجاز به ورود به اين خط است.",
                    "C", "علائم")

                add(155, "اين علامت به چه معناست؟",
                    "باید از سمت راست مانع پیش رو عبور کنید.",
                    "از سمت راست سایر رانندگان سبقت بگیرید.",
                    "جاده پر از پیچ و خم است.",
                    "جاده به سمت راست می‌پیچد.",
                    "A", "علائم")

                add(156, "اين تابلوى راه به چه معناست؟",
                    "مهدكودك در پيش است.",
                    "منطقه عبور بچه ها",
                    "مراقب افراد داراى معلوليت باشيد.",
                    "تقاطع با مدرسه در پيش است",
                    "D", "علائم")

                add(157, "اين راننده از سيگنال دستى استفاده مى كند. راننده قصد دارد …",
                    "به سمت چب برود ، به سمت چپ بپیچد .",
                    "به سمت راست بپيچد .",
                    "سرعت خود را زیاد کند ",
                    "كاهش سرعت کند يا توقف کند . ",
                    "A", "علائم")

                add(158, "اين علامت به چه معناست؟",
                    "پارك هاى استانى را نشان مى دهد",
                    "املاى صحيح شهرها يا شهرستان ها را نشان مى دهد",
                    "كذرگاه راه آهن پیش رو را نشان مى دهد",
                    "فاصله شهرها يا شهرستان ها را نشان مى دهد",
                    "D", "علائم")

                add(159, "اين تابلوى راه به چه معناست؟",
                    "محدوديت سرعت براى مدارس روستایی",
                    "حداكثر سرعت 50 كيلومتر در ساعت از اين علامت تا علامت بعدى",
                    "انتهاى منطقه 50 كيلومتر بر ساعت",
                    "محدوديت سرعت به 50 كيلومتر در ساعت ، جلوتر تغيير می‌كند",
                    "D", "علائم")

                // --- Persian Test 4: Rules (IDs 160...179) ---
                // Reset any stale data in this range first
                do {
                    let fetch4: NSFetchRequest<Question> = Question.fetchRequest()
                    fetch4.predicate = NSPredicate(format: "id >= %d AND id <= %d", 160, 179)
                    let old4 = try context.fetch(fetch4)
                    for obj in old4 { context.delete(obj) }
                    if context.hasChanges { try context.save() }
                } catch {
                    print("Warning: could not delete old Persian questions (160...179): \(error)")
                }

                add(160, "استفاده از كدام يك از موارد زير هنگام رانندگى ممنوع است؟",
                    "لپتاپ",
                    "تلفن همراه دستى",
                    "همه موارد فوق",
                    "پخش كننده ضبط صوت",
                    "C", "قوانین رانندگی")

                add(161, "يك افسر پليس مى تواند از صاحب وسيله نقليه ارائه چه مداركى را درخواست کند؟",
                    "سند مالكيت وسيله نقليه",
                    "گواهينامه رانندگی معتبر",
                    "كارت بيمه مسئوليت",
                    "همه موارد فوق",
                    "D", "قوانین رانندگی")

                add(162, "يك راننده مبتدى كه به رانندگى بی\u{200C}دقت محكوم شده، در سومين تخلف با كداميك از مجازات هاى زير روبرو خواهد شد؟",
                    "جريمه، لغو گواهينامه و حذف از سيستم گواهينامه تدريجى",
                    "فقط حذف از سيستم گواهينامه تدريجى",
                    "جريمه، تعليق گواهينامه و امتياز منفی",
                    "فقط لغو گواهینامه",
                    "A", "قوانین رانندگی")

                add(163, "اگر به دليل رانندگى با سرعت 50 كيلومتر در ساعت بيشتر از حد مجاز محكوم شويد، باكدام يك از مجازات هاى زير روبرو خواهيد شد؟",
                    "حداقل 2000 دلار جريمه",
                    "همه موارد فوق",
                    "تعليق گواهینامه تا 2 سال يا 6 امتياز منفی",
                    "حبس تا 6 ماه",
                    "B", "قوانین رانندگی")

                add(164, "اگر در حين رانندگى خسته شويد، بايد …",
                    "قهوه بنوش.",
                    "موسيقى را بلندتر كنيد",
                    "پنجره هاى خود را باز كنيد تا هواى تازه وارد ماشين شود.",
                    "توقف كنید و استراحت كنید",
                    "D", "قوانین رانندگی")

                add(165, "براى کنترل كردن وسيله نقليه هنگام لغزش خودرو چه بايد كرد؟",
                    "ترمزها را به شدت فشار دهيد",
                    "مستقيم به جلو هدايت كنيد",
                    "درجهت مخالف لغزش هدايت كنيد.",
                    "در مسيرى كه مى\u{200C}خواهيد برويد هدايت كنيد",
                    "D", "قوانین رانندگی")

                add(166, "آيا رانندگان مسئول اين هستند كه کمربند مسافران خود را ببندند؟",
                    "فقط آن مسافرانى كه در صندلى جلو هستند",
                    "فقط مسافران كه 16 سال يا بيشتر دارند.",
                    "فقط مسافران زير 16 سال.",
                    "فقط مسافران بالاى 18 سال.",
                    "C", "قوانین رانندگی")

                add(167, "شما به چند برف\u{200C}روب نزديك مى\u{200C}شويد كه يك آزادراه را پاكسازى مى\u{200C}كنند. چه كارى را نبايد انجام دهيد؟",
                    "سعى كنيد از بين آنها عبور كنيد",
                    "قوانين جاده را رعايت كنيد",
                    "فاصله ايمن را حفظ كنيد",
                    "منتظر بمانيد تا به ترافيك اجازه عبور ايمن دهند",
                    "A", "قوانین رانندگی")

                add(168, "وقتى به يك تقاطع نزديك مى\u{200C}شويد، متوجه مى\u{200C}شويد كه جاده آن سوى تقاطع با ترافيك مسدود شده است. چه كارى بايد انجام دهيد؟",
                    "بوق خود را به صدا درآوريد تا به ترافيك پيش رو براى ادامه مسير هشدار دهيد.",
                    "توقف كن و دريك كافه استراحت کن",
                    "قبل از ورود به تقاطع توقف كنيد و منتظر بمانيد تا ترافيك پيش رو حرکت کند .",
                    "تاحد امكان به خودروى جلويى نزديك شويد.",
                    "C", "قوانین رانندگی")

                add(169, "عبور از يك وسيله نقليه ديگر در سمت راست …",
                    "زمانى مجاز است كه خيابان يا بزرگراه داراى دو يا چند لاين ترافيك در جهتى است كه شما در آن حركت مى\u{200C}كنيد",
                    "زمانى مجاز است كه خيابان يا بزرگراه داراى ترافيك باشد.",
                    "درهر خيابان يا بزرگراه مجاز است.",
                    "مجاز نيست.",
                    "A", "قوانین رانندگی")

                add(170, "هنگام عبور از يك دوچرخه\u{200C}سوار، اگر حداقل 1 متر فاصله نگذازيد، اين كار مى\u{200C}تواند منجر به چند امتياز منفی شود؟",
                    "6",
                    "3",
                    "2",
                    "8",
                    "C", "قوانین رانندگی")

                add(171, "زمانى كه راننده وسيله نقليه ديگرى قصد دارد از سمت چپ شما سبقت بگيرد، چه بايد بكنيد؟",
                    "سرعت بگيريد و در وسط جاده رانندگى كنيد.",
                    "به سمت چپ حركت كنيد و اجازه ندهيد وسيله نقليه سبقت بگيرد.",
                    "به سمت راست حركت كنيد و اجازه دهيد وسيله نقليه سبقت بگيرد.",
                    "به راننده علامت بدهيد كه سبقت نگيرد.",
                    "C", "قوانین رانندگی")

                add(172, "قانون دو ثانيه براى تعيين چه چيزى استفاده مى\u{200C}شود؟",
                    "چقدر سريع مى\u{200C}توانيد به موانع واكنش نشان دهيد",
                    "با چه سرعتى در حال حركت هستيد",
                    "چقدر سوخت صرفه\u{200C}جويى خواهيد كرد",
                    "آيا با فاصله\u{200C}اى امن از ماشين روبرو حركت مى\u{200C}كنيد يا خير",
                    "D", "قوانین رانندگی")

                add(173, "شما به يك منطقه ساخت و ساز نزديك مى\u{200C}شويد. چه كارى بايد انجام دهيد؟",
                    "بوق خود را به صدا درآوريد تا به كارگران هشدار دهيد.",
                    "در صورت لزوم سرعت خود را كاهش دهيد و حق تقدم را بدهيد.",
                    "توقف كنيد تا زمانى كه كارگران به شما علامت دهند كه ادامه دهيد،",
                    "سرعت خود را افزايش دهيد تا به سرعت از منطقه خارج شويد.",
                    "B", "قوانین رانندگی")

                add(174, "مى\u{200C}خواهيد گردش به راست در چراغ قرمزى كه گردش به راست مجاز است انجام دهيد. قبل از ورود و انجام پيچ چه بايد كرد؟",
                    "چراغ راهنماى چپ را روشن كنيد، سپس ادامه دهيد.",
                    "چراغ راهنماى راست را روشن كنيد، سپس ادامه دهيد.",
                    "متوقف شويد. به وسايل نقليه و پياده\u{200C}روها حق تقدم بدهيد. اگر مسير ايمن است، چراغ راهنماى راست را روشن كرده و با احتياط بپيچيد.",
                    "سرعت خود را افزايش دهيد، سپس ادامه دهيد.",
                    "C", "قوانین رانندگی")

                add(175, "خطوط سفيد شكسته نشان\u{200C}دهنده چيست؟",
                    "آنها خطوط ترافيكى را كه در جهت مخالف حركت مى\u{200C}كنند جدا مى\u{200C}كنند.",
                    "آنها نشان مى\u{200C}دهند كه عبور از خطوط ممنوع است.",
                    "آنها نشان مى\u{200C}دهند كه جاده جلوتر به پايان مى\u{200C}رسد",
                    "آنها لاين\u{200C}هاى ترافيكى را كه در يك جهت حركت مى\u{200C}كنند جدا مى\u{200C}كنند",
                    "D", "قوانین رانندگی")

                add(176, "در جاده\u{200C}اى با ترافيك دوطرفه، قصد داريد به چپ بپيچيد. در چه موقعيتى بايد باشيد؟",
                    "نزديك به سمت راست جاده",
                    "نزديك به سمت چپ جاده",
                    "در هر موقعيتى؛ فقط سيگنال مهم است.",
                    "در سمت راست و تا حد امكان نزديك به خط مركزى جاده",
                    "D", "قوانین رانندگی")

                add(177, "اگر به دليل عدم توقف هنگام دستور توقف افسر پليس محكوم شويد، ممكن است با كدام مجازات\u{200C}ها روبرو شويد؟",
                    "تا 6 ماه زندان",
                    "جريمه تا 25000 دلار",
                    "تعليق مجوز به مدت 5 سال",
                    "همه موارد فوق",
                    "D", "قوانین رانندگی")

                add(178, "بدون انجام چه كارهايى نبايد تغيير لاين داد؟",
                    "دادن سيگنال مناسب و سپس اطمينان از ايمنى تغيير خط",
                    "بوق زدن و سپس اطمينان از ايمنى",
                    "دادن سيگنال به موقع و كاهش سرعت",
                    "فقط نگاه به آينه و تغيير لاين",
                    "A", "قوانین رانندگی")

                add(179, "اگر براى اتوبوس مدرسه\u{200C}اى كه چراغ قرمز آن چشمك مى\u{200C}زند، توقف نكنيد، براى اولين بار با كدام مجازات روبرو مى\u{200C}شويد؟",
                    "جريمه تا 2000 دلار و 6 امتياز منفی",
                    "الزام مجدد براى شركت در تست\u{200C}هاى جاده\u{200C}اى",
                    "جريمه تا 1000 دلار و 3 امتياز منفی",
                    "1 سال حبس",
                    "A", "قوانین رانندگی")

                if context.hasChanges { try? context.save() }
            }
        }
